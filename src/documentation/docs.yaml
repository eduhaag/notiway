openapi: 3.0.3
info: 
  title: NotiWay - Whatsapp Notifications Sender - API REST
  x-logo:
    url: https://api.notiway.com.br/images/logo.png
  description: |-
    # Introdução
    NotiWay é uma **API Rest** eficiente e fácil de usar para envio de notificações via WhatsApp, voltada tanto para pequenas e médias empresas quanto para desenvolvedores de aplicações. Com a nossa API, você pode enviar mensagens personalizadas, promocionais ou informativas diretamente para os clientes, mantendo uma comunicação direta e eficaz.

    A API é baseada no modelo SaaS (Software as a Service) e pode ser integrada facilmente com outras aplicações e serviços, proporcionando mais eficiência e praticidade para a sua empresa.

    A API atua utilizando o Web Whatsapp da Meta, simulando o envio de mensagens pelo próprio navegador, dessa forma permite a automação de envio de mensagens.

    Nossa equipe está sempre à disposição para ajudar em qualquer dúvida ou problema que possa surgir, garantindo uma experiência de uso excepcional para nossos clientes. Se você está procurando uma solução moderna e eficiente para envio de notificações via WhatsApp, a API da NotiWay é a escolha perfeita!

    # Autenticação
    A autenticação na API é feita por meio de uma `api-key` enviada no `headers` da solicitação;

    Para obter a `api-key` você deve acessar sua conta em <a href="https://notiway.com.br" target="_blank">notiway.com.br</a>, selecionar a opção "Clients" no menu, em seguida clicar sobre o _client_ desejado e então será exibida uma caixa de texto com a `api-key` oculta. Você tem as opções de exibir ou copiar a chave para área de transferência conforme imagem abaixo:

    <img src="/images/client_key.png" alt=""/>

    **Atenção!** Clicar em *Gerar nova chave*, invalida a `api-key` anterior, sendo necessário substituí-la nas suas aplicações em produção.

    <SecurityDefinitions />

    # Sincronização do Whatsapp
    Nossa API funciona através do Whastapp Web, dessa forma caso você não tenha feito a assinatura de um número virtual conosco ou não tenha contratado o plano com número compartilhado, é necessário que você realize a sincronização da sua conta do Whatsapp com a API. Para isso, siga os passos abaixo:

    <ol style="display: flex; flex-direction:column; gap:1rem;">
      <li> Acesse a opção <b>Senders</b> no menu em <a href="https://notiway.com.br/senders" target="_blank">notiway.com.br</a>;</li>
      <li> Clique sobre o <i>sender</i> desejado;</li>
      <li> Confirme se o número do telefone cadastrado está correto, caso contrário nos comunique o mais rápido possível clicando <a href="https://wa.me/5547996788597" target="_blank">aqui</a>;</li>
      <li> Acesse o Whatsapp em seu celular e siga de acordo com seu sistema:
        <ul style="display:flex; flex-direction:column; gap: 0.5rem;">    
          <li><strong>Android:</strong> toque em <b>Mais opções</b><img src="/images/dot_menu.png" style="max-width: 25px; max-height: 25px;" alt="Atalho de menu de 3 pontos do whatsapp" /> >  <b>Aparelhos conetados</b> > <b>Conectar aparelho</b>.</li>
          <li><strong>IPhone:</strong> toque em <b>Configurações</b>&nbsp<img src="/images/iphone_config.png" style="max-width: 25px; max-height: 25px" alt="Icone de engrenagem" /> > <b>Aparelhos conetados</b> > <b>Conectar aparelho</b>.</li>
          <span style="display:block; margin-bottom: 1rem;">Lembre-se que cada conta do Whatsapp pode estar conectada a no máximo 4 dispositivos diferentes. Caso você já tenha atingido este limite, será necessário desconectar algum dispositivo para sincronizar com a API.</span>
        </ul>
      </li>
      <li> Desbloqueie seu celular:
        <ul style="display:flex; flex-direction:column; gap: 0.5rem;">
          <li> Se a autenticação biométrica estiver ativada, siga as instruções exibidas na tela.</li>
          <li> Se a autenticação biométrica não estiver ativada, será necessário informar o código usado para desbloquear o celular.</li>
        </ul>
      </li>
      <li> Clique na opção <b>Conectar</b> no <i>sender</i> selecionado no site e aguarde gerar o <b>QR Code</b>;
          <img src="/images/connect.png" alt="Tela de conexão no site Notiway.com.br" style="display:block; margin-bottom:1rem;" />
      </li>
      <li> Quando o <b>QR Code</b> for exibido, basta fazer o escaneamento com a câmera do seu celular. Para esta operação você terá cerca de 50 segundos. Caso o tempo encerre sem que ocorra a leitura do QR Code, será exibido um alerta informando falha na leitura e você poderá iniciar novamente do passo 6.
          <img src="/images/qr_code.png" alt="Tela de leitura do QR Code" style="display:block; margin-bottom:1rem;" />
      </li>
      <li>Após a leitura ser realizada com sucesso, aguarde até que o <b>status da conexão em seu celular</b> esteja como <b>Ativo</b>.
          <img src="/images/connection_status.jpeg" alt="Tela de status da conexão no Whatsapp" style="display: block; max-width:300px"/>
      </li>
      <li><b>Pronto!</b> Agora você já pode utilizar a API com a sua conta do Whatsapp.</li>
    </ul>

    # Formatação de textos
    É possivel formatar os textos enviados pela API, colocando o texto desejado entre caracteres especiais conforme abaixo:

      - <div>
      <p>
        <b>Itálico</b><br />
        Para escrever sua mensagem em <i>itálico</i>, insira o sinal de sublinhado (<i>underline</i>) antes e depois do texto:<br/>
        _texto em itálico_ = <i>texto em itálico</i>
      </p>
      </div>
      <br />
      - <div>
      <p>
        <b>Negrito</b><br />
        Para escrever sua mensagem em <b>negrito</b>, insira um asterisco antes e depois do texto: <br />
        *texto em negrito* = <b>texto em negrito</b>
      </p>
      </div>
      - <div>
      <p>
        <b>Tachado</b><br />
        Para <s>tachar</s> sua mensagem, insira um til antes e depois do texto: <br />
        ~texto tachado~ = <s>texto tachado</s>
      </p>
      </div>
      - <div>
      <p>
        <b>Monoespaçado</b><br />
        Para escrever sua mensagem <span style="font-family: monospace">monoespaçada</span>, insira três sinais graves antes e depois do texto: <br />
        ```texto monoespaçado``` = <span style="font-family: monospace">texto monoespaçado</span>
      </p>
      </div>

    # Usar emoji nas mensagens
    <p>Você pode utilizar emojis nas mensagens de texto. Para isso basta incluir o emoji diretamente na mensagem.</p>
    <p>Caso você não tenha nenhuma ferramenta que permita a inclusão de emojis, você pode utilizar o site <a href="https://getemoji.com/" target="_blanck">getemoji.com</a> para copiar o emoji desejado e colar diretamente na sua mensagem.</p>

  termsOfService: https://api.notiway.com.br/terms
  contact:
    email: atendimento@notiway.com.br
  version: 1.0.0
servers:
  - url: https://api.notiway.com.br/v1
paths:
  /send-text:    
    post:
      operationId: sendText
      summary: Enviar mensagem de texto
      description: |
        Está rota é reponsável pelo envio de uma mensagem de texto comum para o desinatário.

        O destinatário presente no campo `to` deve ser em formato string contendo apenas os números do contato. 

        Ex.: para o telefone brasileiro **(11) 9 9999-9999** usar `to:'5511999999999'`.</br>        
        Obs.: O 55 corresponde ao +55 que identifica os telefones brasileiros internacionalmente.

      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/textMessage"
        required: true
      responses:
        '200':
          $ref: "#/components/responses/successResponse"
        '400':
          $ref: "#/components/responses/ValidationError"
        '401':
          $ref: "#/components/responses/UnauthorizedError"
        '425':
          $ref: "#/components/responses/NotReadyError"
        '5xx':
          $ref: "#/components/responses/ServerError"
      security: 
        -  api_keys: []
  /send-link:
    post:
      operationId: sendLink
      summary: Enviar link preview
      description: |
        Esta rota é reponsável pelo envio de uma mensagem contendo um link com o preview do mesmo para o desinatário.
        
        O destinatário presente no campo `to` deve ser em formato string contendo apenas os números do contato. 

        Ex.: para o telefone brasileiro **(11) 9 9999-9999** usar `to:'5511999999999'`.</br>        
        Obs.: O 55 corresponde ao +55 que identifica os telefones brasileiros internacionalmente.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/linkMessage'
        required: true
      responses:
        '200':
          $ref: "#/components/responses/successResponse"
        '400':
          $ref: "#/components/responses/ValidationError"
        '401':
          $ref: "#/components/responses/UnauthorizedError"
        '425':
          $ref: "#/components/responses/NotReadyError"
        '5xx':
          $ref: "#/components/responses/ServerError"
      security: 
        -  api_keys: []
  /send-location:
    post:
      operationId: sendLocation
      summary: Enviar localização
      description: |
        Esta rota é reponsável pelo envio de uma localização e/ou um endereço ao detinatário.
        Ao destinatário será exibida uma prévia da localização no maps.

        O destinatário presente no campo `to` deve ser em formato string contendo apenas os números do contato. 

        Ex.: para o telefone brasileiro **(11) 9 9999-9999** usar `to:'5511999999999'`.</br>        
        Obs.: O 55 corresponde ao +55 que identifica os telefones brasileiros internacionalmente.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/locationMessage'
        required: true
      responses:
        '200':
          $ref: "#/components/responses/successResponse"
        '400':
          $ref: "#/components/responses/ValidationError"
        '401':
          $ref: "#/components/responses/UnauthorizedError"
        '425':
          $ref: "#/components/responses/NotReadyError"
        '5xx':
          $ref: "#/components/responses/ServerError"
      security: 
        -  api_keys: []
  /send-contact:
    post:
      operationId: sendContact
      summary: Enviar um contato
      description: |
        Esta rota é responsável por enviar um contato para o destinário, de forma que seja possivel salvar o contato da agenda do destinatário.

        O destinatário presente no campo `to` deve ser em formato string contendo apenas os números do contato. 

        Ex.: para o telefone brasileiro **(11) 9 9999-9999** usar `to:'5511999999999'`.</br>        
        Obs.: O 55 corresponde ao +55 que identifica os telefones brasileiros internacionalmente.
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/contactMessage"
        required: true
      responses:
        '200':
          $ref: "#/components/responses/successResponse"
        '400':
          $ref: "#/components/responses/ValidationError"
        '401':
          $ref: "#/components/responses/UnauthorizedError"
        '425':
          $ref: "#/components/responses/NotReadyError"
        '5xx':
          $ref: "#/components/responses/ServerError"
      security: 
        -  api_keys: []
  /send-gif:
    post:
      operationId: sendGif
      summary: Enviar um gif
      description: |
        Esta rota é responsável por enviar um gif animado ou estático ao destinatário.

        O destinatário presente no campo `to` deve ser em formato string contendo apenas os números do contato. 

        Ex.: para o telefone brasileiro **(11) 9 9999-9999** usar `to:'5511999999999'`.</br>        
        Obs.: O 55 corresponde ao +55 que identifica os telefones brasileiros internacionalmente.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/gifMessage'
        required: true
      responses:
        '200':
          $ref: "#/components/responses/successResponse"
        '400':
          $ref: "#/components/responses/ValidationError"
        '401':
          $ref: "#/components/responses/UnauthorizedError"
        '425':
          $ref: "#/components/responses/NotReadyError"
        '5xx':
          $ref: "#/components/responses/ServerError"
      security: 
        -  api_keys: []
  /send-sticker:
    post:
      operationId: sendSticker
      summary: Enviar um sticker
      description: |
        Esta rota é responsável por enviar um sticker/figurinha ao destinatário.

        O destinatário presente no campo `to` deve ser em formato string contendo apenas os números do contato. 

        Ex.: para o telefone brasileiro **(11) 9 9999-9999** usar `to:'5511999999999'`.</br>        
        Obs.: O 55 corresponde ao +55 que identifica os telefones brasileiros internacionalmente.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/stickerMessage'
        required: true
      responses:
        '200':
          $ref: "#/components/responses/successResponse"
        '400':
          $ref: "#/components/responses/ValidationError"
        '401':
          $ref: "#/components/responses/UnauthorizedError"
        '425':
          $ref: "#/components/responses/NotReadyError"
        '5xx':
          $ref: "#/components/responses/ServerError"
      security: 
        - api_keys: []
  /send-image:
    post:
      operationId: sendImage
      summary: Enviar uma imagem
      description: |
        Esta rota é responsável por enviar uma imagem ao destinatário.

        O arquivo da imagem deve ser convertido em uma URI Base64 e enviado para API apenas a  string.
      
        O destinatário presente no campo `to` deve ser em formato string contendo apenas os números do contato. 

        Ex.: para o telefone brasileiro **(11) 9 9999-9999** usar `to:'5511999999999'`.</br>        
        Obs.: O 55 corresponde ao +55 que identifica os telefones brasileiros internacionalmente.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/imageMessage'
        required: true
      responses:
        '200':
          $ref: "#/components/responses/successResponse"
        '400':
          $ref: "#/components/responses/ValidationError"
        '401':
          $ref: "#/components/responses/UnauthorizedError"
        '425':
          $ref: "#/components/responses/NotReadyError"
        '5xx':
          $ref: "#/components/responses/ServerError"
      security: 
        - api_keys: []
  /send-file:
    post:
      operationId: sendFile
      summary: Enviar um arquivo
      description: |
        Esta rota é responsável por enviar um arquivo ao destinatário.

        O arquivo deve ser convertido em uma URI Base64 e enviado para API apenas a  string.
      
        O destinatário presente no campo `to` deve ser em formato string contendo apenas os números do contato. 

        Ex.: para o telefone brasileiro **(11) 9 9999-9999** usar `to:'5511999999999'`.</br>        
        Obs.: O 55 corresponde ao +55 que identifica os telefones brasileiros internacionalmente.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/fileMessage'
        required: true
      responses:
        '200':
          $ref: "#/components/responses/successResponse"
        '400':
          $ref: "#/components/responses/ValidationError"
        '401':
          $ref: "#/components/responses/UnauthorizedError"
        '425':
          $ref: "#/components/responses/NotReadyError"
        '5xx':
          $ref: "#/components/responses/ServerError"
      security: 
        - api_keys: []
  /send-audio:
    post:
      operationId: sendAudio
      summary: Enviar um arquivo de áudio
      description: |
        Esta rota é responsável por enviar um arquivo de áudio ao destinatário, simulando um áudio gravado no próprio Whatsapp.

        O arquivo deve ser convertido em uma URI Base64 e enviado para API apenas a  string.
      
        O destinatário presente no campo `to` deve ser em formato string contendo apenas os números do contato. 

        Ex.: para o telefone brasileiro **(11) 9 9999-9999** usar `to:'5511999999999'`.</br>        
        Obs.: O 55 corresponde ao +55 que identifica os telefones brasileiros internacionalmente.
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/audioMessage'
        required: true
      responses:
        '200':
          $ref: "#/components/responses/successResponse"
        '400':
          $ref: "#/components/responses/ValidationError"
        '401':
          $ref: "#/components/responses/UnauthorizedError"
        '425':
          $ref: "#/components/responses/NotReadyError"
        '5xx':
          $ref: "#/components/responses/ServerError"
      security: 
        - api_keys: []
components:
  schemas:
    textMessage:
      required:
        - to
        - message
      type: object
      properties:
        to:
          type: string
          example: '5511999999999'
        message:
          type: string
          example: Esta mensagem será enviada ao contato
    linkMessage:
      required:
        - to
        - url
      type: object
      properties:
        to:
          type: string
          example: '5511999999999'
        url:
          type: string
          example: http://www.google.com.br
        message:
          type: string
          example: Esta mensagem será enviada ao contato
    locationMessage:
      required:
        - to
      type: object
      properties:
        to:
          type: string
          example: '5511999999999'
        latitude:
          type: number
          example: -23.561414
        longitude:
          type: number
          example: -46.6558819
        title:
          type: string
          example: MASP - Museu de Artes de São Paulo
        address:
          type: string
          example: Av. Paulista, 1578 - Bela Vista, São Paulo - SP, 01310-200
    contactMessage:
      required:
        - to
        - name
        - contact
      type: object
      properties:
        to:
          type: string
          example: '5511999999999'
        name:
          type: string
          example: John Doe
        contact:
          type: string
          example: '5511988888888'
    gifMessage:
      required:
        - to
        - url
      type: object
      properties:
        to:
          type: string
          example: '5511999999999'
        url:
          type: string
          example: https://media.giphy.com/media/hpXFi66bfQm7e81ohw/giphy.gif
    stickerMessage:
      required:
        - to
        - url
      type: object
      properties:
        to:
          type: string
          example: '5511999999999'
        url:
          type: string
          example: https://www.camarabracodotrombudo.sc.gov.br/media/noticia/link-para-participacao-da-audiencia-publica-54.jpg
    imageMessage:
      required:
        - to
        - base64
      type: object
      properties:
        to:
          type: string
          example: '5511999999999'
        base64:
          $ref: image.yaml
        message:
          type: string
          example: Descrição da imagem
    fileMessage:
      required:
        - to
        - base64
        - filename
      type: object
      properties:
        to:
          type: string
          example: '5511999999999'
        base64:
          $ref: file.yaml
        filename:
          type: string
          example: recibo.pdf
    audioMessage:
      required:
        - to
        - base64
      type: object
      properties:
        to:
          type: string
          example: '5511999999999'
        base64:
          $ref: audio.yaml
  responses:
    successResponse:
      description: Successful operation
      content:
        status:
          schema: 
            type: object
            properties:
              status:
                type: string
                example: sended  
    UnauthorizedError:
      description: Unauthorized.
    NotReadyError:
      description: Client or sender not ready.
    ValidationError:
      description: Validation error.
    ServerError:
      description: Unexpected error.
  securitySchemes:
    api_keys:
      description: Consulte a API Key em <a href="https://notiway.com.br" target="_blank">notiway.com.br</a>
      name: api-key
      type: apiKey
      in: header
